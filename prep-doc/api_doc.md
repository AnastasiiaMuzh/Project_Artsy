# API Documentation

## USER AUTHENTICATION/AUTHORIZATION

All endpoints that require authentication
All endpoints that require a current user to be logged in.
Request: endpoints that require authentication
Error Response: Require authentication
Status Code: 401
Headers:
Content-Type: application/json
Body:
{
  "message": "Authentication required"
}

All endpoints that require proper authorization
All endpoints that require authentication and the current user does not have the correct role(s) or permission(s).
Request: endpoints that require proper authorization
Error Response: Require proper authorization
Status Code: 403
Headers:
Content-Type: application/json
Body:
{
  "message": "Forbidden"
}

Get the Current User
Returns the information about the current user that is logged in.
Require Authentication: false
Request
Method: GET
Route path: /api/:user
Body: none
Successful Response when there is a logged in user
Status Code: 200
Headers:
Content-Type: application/json
Body:
{
  "user": {
    "id": 1,
    "firstName": "John",
    "lastName": "Smith", 
    "username": "Smith_John",
    "email": "john.smith@gmail.com",
  }
}

Successful Response when there is no logged-in user
Status Code: 200
Headers:
Content-Type: application/json
Body:
{
  "user": null
}

Log In a User
Logs in a current user with valid credentials and returns the current user's information.
Require Authentication: false
Request
Method: POST
Route path: /api/login
Headers:
Content-Type: application/json
Body:
{
  "credential": "john.smith@gmail.com",
  "password": "secret password"
}

Successful Response
Status Code: 200
Headers:
Content-Type: application/json
Body:
{
  "user": {
    "id": 1,
    "firstName": "John",
    "lastName": "Smith", 
    "username": "Smith_John",
    "email": "john.smith@gmail.com",
  }
}

Error Response: Invalid credentials
Status Code: 401
Headers:
Content-Type: application/json
Body:
{
  "message": "Invalid credentials"
}

Error response: Body validation errors
Status Code: 400
Headers:
Content-Type: application/json
Body:
{
  "message": "Bad Request", // (or "Validation error" if generated by Sequelize),
  "errors": {
    "credential": "Email or username is required",
    "password": "Password is required"
  }
}

Sign Up a User
Creates a new user, logs them in as the current user, and returns the current user's information.
Require Authentication: false
Request
Method: POST
Route path: /api/signup
Headers:
Content-Type: application/json
Body:
{
  "firstName": "John",
  "lastName": "Smith",
  "email": "john.smith@gmail.com",
  "username": "JohnSmith",
  "password": "secret password"
}

Successful Response
Status Code: 201
Headers:
Content-Type: application/json
Body:
{
  "user": {
    "id": 1,
    "firstName": "John",
    "lastName": "Smith",
    "email": "john.smith@gmail.com",
    "username": "JohnSmith"
  }
}

Error response: User already exists with the specified email or username
Status Code: 500
Headers:
Content-Type: application/json
Body:
{
  "message": "User already exists",
  "errors": {
    "email": "User with that email already exists",
    "username": "User with that username already exists"
  }
}

Error response: Body validation errors
Status Code: 400
Headers:
Content-Type: application/json
Body:
{
  "message": "Bad Request", // (or "Validation error" if generated by Sequelize),
  "errors": {
    "email": "Invalid email",
    "username": "Username is required",
    "firstName": "First Name is required",
    "lastName": "Last Name is required"
  }
}

## PRODUCTS

Get all Products
Returns all the products.
Require Authentication: false
Request
Method: GET
Route path: /api/products
Body: none
Successful Response
Status Code: 200
Headers:
Content-Type: application/json
Body:
{
  "Products": [
    {
      "id": 1,
      "name": "Pure Cashmere Neck Warmer",
      "storeId": "1",
      "description": "100% Cashmere neck warmer in beautiful neutral and earthy colors.",
      "price": 60,
      "category": "Scarf",
      "createdAt": "2021-11-19 20:39:36",
      "updatedAt": "2021-11-19 20:39:36",
      "avgRating": 4.5,
      "previewImage": "image url"
    }
  ]
}

Get all Products being sold/owned by the Current User
Returns all the products owned (created) by the current user.
Require Authentication: true
Request
Method: GET
Route path: /api/products/:sellerId
Body: none
Successful Response
Status Code: 200
Headers:
Content-Type: application/json
Body:
{
  "Products": [
    {
      "id": 1,
      "name": "Pure Cashmere Neck Warmer",
      "storeId": "1",
      "sellerId": "1",
      "description": "100% Cashmere neck warmer in beautiful neutral and earthy colors.",
      "price": 60,
      "category": "Scarves",
      "createdAt": "2021-11-19 20:39:36",
      "updatedAt": "2021-11-19 20:39:36",
      "avgRating": 4.5,
      "previewImage": "image url"
    }
  ]
}

Get details of a Product from an id
Returns the details of a product specified by its id.
Require Authentication: false
Request
Method: GET
Route path: /api/products/:id
Body: none
Successful Response
Status Code: 200
Headers:
Content-Type: application/json
Body:
{
  "id": 1,
  "storeId": 1,
  "name": "Pure Cashmere Neck Warmer",
  "description": "100% Cashmere neck warmer in beautiful neutral and earthy colors.",
  "price": "60",
  "category": "Scarves",
  "createdAt": "2021-11-19 20:39:36",
  "updatedAt": "2021-11-19 20:39:36" ,
  "numReviews": 5,
  "avgStarRating": 4.5,
  "ProductImages": [
    {
      "id": 1,
      "url": "image url",
      "preview": true
    },
    {
      "id": 2,
      "url": "image url",
      "preview": false
    }
  ],
  "Store": {
    "id": 1,
"sellerId": 1,
    "storeName": "RoseBoutique",
  }
}

Error response: Couldn't find a Product with the specified id
Status Code: 404
Headers:
Content-Type: application/json
Body:
{
  "message": "Product couldn't be found"
}

Create a Product
Creates and returns a new product.
Require Authentication: true
Request
Method: POST
Route path: /api/products
Headers:
Content-Type: application/json
Body:
{
  "name": "Pure Cashmere Neck Warmer",
  "description": "100% Cashmere neck warmer in beautiful neutral and earthy colors.",
  "price": 60,
"category": "Scarves"
}

Successful Response
Status Code: 201
Headers:
Content-Type: application/json
Body:
{
  "id": 1,
  "storeId": 1,
"sellerId": "1",
  "name": "Pure Cashmere Neck Warmer",
  "description": "100% Cashmere neck warmer in beautiful neutral and earthy colors.",
  "price": 60,
"category": "Scarves",
  "createdAt": "2021-11-19 20:39:36",
  "updatedAt": "2021-11-19 20:39:36"
}

Error Response: Body validation errors
Status Code: 400
Headers:
Content-Type: application/json
Body:
{
  "message": "Bad Request", // (or "Validation error" if generated by Sequelize),
  "errors": {
    "name": "Name must be less than 50 characters",
    "description": "Description is required",
    "price": "Price must be a positive number"
"category": "Category is required"
  }
}

Add an Image to a Product based on the Product's id
Create and return a new image for a Product specified by id.
Require Authentication: true
Require proper authorization: Product must belong to the current user
Request
Method: POST
Route path: /api/products/:id/productImages
Headers:
Content-Type: application/json
Body:
{
  "url": "image url",
  "preview": true
}

Successful Response
Status Code: 201
Headers:
Content-Type: application/json
Body:
{
  "id": 1,
  "url": "image url",
  "preview": true
}

Error response: Couldn't find a Product with the specified id
Status Code: 404
Headers:
Content-Type: application/json
Body:
{
  "message": "Product couldn't be found"
}

Edit a Product
Updates and returns an existing product.
Require Authentication: true
Require proper authorization: Product must belong to the current user
Request
Method: PUT
Route path: /api/products/:user
Headers:
Content-Type: application/json
Body:
{
  "name": "Pure Cashmere Neck Warmer",
  "description": "100% Cashmere neck warmer in beautiful neutral and earthy colors.",
  "price": 60,
"category": "Scarves"
}

Successful Response
Status Code: 200
Headers:
Content-Type: application/json
Body:
{
      "id": 1,
      "name": "Pure Cashmere Neck Warmer",
      "storeId": "1",
"sellerId": "1",
      "description": "100% Cashmere neck warmer in beautiful neutral and earthy colors.",
      "price": 60,
"category": "Scarf",
      "createdAt": "2021-11-19 20:39:36",
      "updatedAt": "2021-11-19 20:39:36",
    }
}

Error Response: Body validation errors
Status Code: 400
Headers:
Content-Type: application/json
Body:
{
  "message": "Bad Request", // (or "Validation error" if generated by Sequelize),
  "errors": {
   "name": "Name must be less than 50 characters",
    "description": "Description is required",
    "price": "Price must be a positive number"
"category": "Category is required"
  }
}

Error response: Couldn't find a Product with the specified id
Status Code: 404
Headers:
Content-Type: application/json
Body:
{
  "message": "Product couldn't be found"
}

Delete a Product
Deletes an existing product.
Require Authentication: true
Require proper authorization: Product must belong to the current user
Request
Method: DELETE
Route path: /api/products/:id
Body: none
Successful Response
Status Code: 200
Headers:
Content-Type: application/json
Body:
{
  "message": "Successfully deleted"
}

Error response: Couldn't find a Product with the specified id
Status Code: 404
Headers:
Content-Type: application/json
Body:
{
  "message": "Product couldn't be found"
}

REVIEWS
Get all Reviews of the Current User
Returns all the reviews written by the current user.
Require Authentication: true
Request
Method: GET
Route path: /api/reviews/:userId
Body: none
Successful Response
Status Code: 200
Headers:
Content-Type: application/json
Body:
{
  "Reviews": [
    {
      "id": 1,
      "productId": 1,
      "buyerId": 1,
      "review": "Awesome product! Will buy again!",
      "stars": 5,
      "createdAt": "2021-11-19 20:39:36",
      "updatedAt": "2021-11-19 20:39:36" ,
      "User": {
        "id": 1,
        "firstName": "John",
        "lastName": "Smith"
      },
      "Products": {
        "id": 1,
"name": "Wireless Bluetooth Earbuds with Noise Cancellation",
        "storeId": 1,
"sellerId": 1,
"price": 123,
"description": "Immerse yourself in exceptional audio quality with our Wireless Bluetooth Earbuds. Designed for seamless connectivity and superior sound, these earbuds feature advanced noise cancellation technology, ensuring uninterrupted listening even in noisy environments.",
        "category": "Technology",        
        "previewImage": "image url"
      },
      "ReviewImages": [
        {
          "id": 1,
          "url": "image url"
        }
      ]
    }
  ]
}

Get all Reviews by a Product's id
Returns all the reviews that belong to a product specified by id.
Require Authentication: false
Request
Method: GET
Route path: /api/reviews/:productId
Body: none
Successful Response
Status Code: 200
Headers:
Content-Type: application/json
Body:
{
  "Reviews": [
    {
      "id": 1,
      "productId": 1,
      "buyerId": 1,
      "review": "Awesome product! Will buy again!",
      "stars": 5,
      "createdAt": "2021-11-19 20:39:36",
      "updatedAt": "2021-11-19 20:39:36" ,
      "User": {
        "id": 1,
        "firstName": "John",
        "lastName": "Smith"
      },
      "ReviewImages": [
        {
          "id": 1,
"reviewId": 1
          "url": "image url"
        }
      ],
    }
  ]
}

Error response: Couldn't find a Product with the specified id
Status Code: 404
Headers:
Content-Type: application/json
Body:
{
  "message": "Product couldn't be found"
}

Create a Review for a Product based on the Product's id
Create and return a new review for a product specified by id.
Require Authentication: true
Request
Method: POST
Route path: /api/reviews/products/:productId
Headers:
Content-Type: application/json
Body:
{
  "review": "Awesome product! Will buy again!!",
  "stars": 5,
}

Successful Response
Status Code: 201
Headers:
Content-Type: application/json
Body:
{
  "id": 1,
  "productId": 1,
  "buyerId": 1,
  "review": "Awesome product! Will buy again!",
  "stars": 5,
  "createdAt": "2021-11-19 20:39:36",
  "updatedAt": "2021-11-19 20:39:36"
}

Error Response: Body validation errors
Status Code: 400
Headers:
Content-Type: application/json
Body:
{
  "message": "Bad Request", // (or "Validation error" if generated by Sequelize),
  "errors": {
    "review": "Review text is required",
    "stars": "Stars must be an integer from 1 to 5",
  }
}

Error response: Couldn't find a Product with the specified id
Status Code: 404
Headers:
Content-Type: application/json
Body:
{
  "message": "Product couldn't be found"
}

Error response: Review from the current user already exists for the Product
Status Code: 500
Headers:
Content-Type: application/json
Body:
{
  "message": "User already has a review for this product"
}

Add an Image to a Review based on the Review's id
Create and return a new image for a review specified by id.
Require Authentication: true
Require proper authorization: Review must belong to the current user
Request
Method: POST
Route path: /api/reviews/:id/:url
Headers:
Content-Type: application/json
Body:
{
  "url": "image url"
}

Successful Response
Status Code: 201
Headers:
Content-Type: application/json
Body:
{
  "id": 1,
  "url": "image url"
}

Error response: Couldn't find a Review with the specified id
Status Code: 404
Headers:
Content-Type: application/json
Body:
{
  "message": "Review couldn't be found"
}

Error response: Cannot add any more images because there is a maximum of 10 images per resource
Status Code: 403
Headers:
Content-Type: application/json
Body:
{
  "message": "Maximum number of images for this resource was reached"
}

Edit a Review
Update and return an existing review.
Require Authentication: true
Require proper authorization: Review must belong to the current user
Request
Method: PATCH
Route path: /api/reviews/:id
Headers:
Content-Type: application/json
Body:
{
  "review": "Awesome product! Will buy again!",
  "stars": 5,
}

Successful Response
Status Code: 200
Headers:
Content-Type: application/json
Body:
{
  "id": 1,
  "productId": 1,
  "buyerId": 1,
  "review": "Awesome product! Will buy again!",
  "stars": 5,
  "createdAt": "2021-11-19 20:39:36",
  "updatedAt": "2021-11-20 10:06:40"
}

Error Response: Body validation errors
Status Code: 400
Headers:
Content-Type: application/json
Body:
{
  "message": "Bad Request", // (or "Validation error" if generated by Sequelize),
  "errors": {
    "review": "Review text is required",
    "stars": "Stars must be an integer from 1 to 5",
  }
}

Error response: Couldn't find a Review with the specified id
Status Code: 404
Headers:
Content-Type: application/json
Body:
{
  "message": "Review couldn't be found"
}

Delete a Review
Delete an existing review.
Require Authentication: true
Require proper authorization: Review must belong to the current user
Request
Method: DELETE
Route path: /api/reviews/:id
Body: none
Successful Response
Status Code: 200
Headers:
Content-Type: application/json
Body:
{
  "message": "Successfully deleted"
}

Error response: Couldn't find a Review with the specified id
Status Code: 404
Headers:
Content-Type: application/json
Body:
{
  "message": "Review couldn't be found"
}

IMAGES
Delete a Product Image
Delete an existing image for a Product.
Require Authentication: true
Require proper authorization: Product must belong to the current user
Request
Method: DELETE
Route path: /api/products/:productsId/:url
Body: none
Successful Response
Status Code: 200
Headers:
Content-Type: application/json
Body:
{
  "message": "Successfully deleted"
}

Error response: Couldn't find a Product Image with the specified id
Status Code: 404
Headers:
Content-Type: application/json
Body:
{
  "message": "Product Image couldn't be found"
}

Delete a Review Image
Delete an existing image for a Review.
Require Authentication: true
Require proper authorization: Review must belong to the current user
Request
Method: DELETE
Route path: /api/reviews/:url
Body: none
Successful Response
Status Code: 200
Headers:
Content-Type: application/json
Body:
{
  "message": "Successfully deleted"
}

Error response: Couldn't find a Review Image with the specified id
Status Code: 404
Headers:
Content-Type: application/json
Body:
{
  "message": "Review Image couldn't be found"
}

## SHOPPING CART

### Get Shopping Cart
Returns the current user's shopping cart contents.
Require Authentication: true
Request
Method: GET
Route path: /api/cart
Body: none

Successful Response
Status Code: 200
Headers:
Content-Type: application/json
Body:
{
  "CartItems": [
    {
      "id": 1,
      "userId": 1,
      "productId": 1,
      "quantity": 2,
      "Product": {
        "id": 1,
        "name": "Pure Cashmere Neck Warmer",
        "price": 60,
        "description": "100% Cashmere neck warmer...",
        "previewImage": "image url"
      }
    }
  ],
  "total": 120
}

### Add to Cart
Adds a product to the user's shopping cart.
Require Authentication: true
Request
Method: POST
Route path: /api/cart
Headers:
Content-Type: application/json
Body:
{
  "productId": 1,
  "quantity": 1
}

Successful Response
Status Code: 201
Headers:
Content-Type: application/json
Body:
{
  "id": 1,
  "userId": 1,
  "productId": 1,
  "quantity": 1,
  "Product": {
    "id": 1,
    "name": "Pure Cashmere Neck Warmer",
    "price": 60
  }
}

### Remove from Cart
Removes a product from the user's shopping cart.
Require Authentication: true
Request
Method: DELETE
Route path: /api/cart/:productId
Body: none

Successful Response
Status Code: 200
Headers:
Content-Type: application/json
Body:
{
  "message": "Successfully removed from cart"
}

### Complete Purchase
Processes the cart items as a transaction.
Require Authentication: true
Request
Method: POST
Route path: /api/cart/checkout
Headers:
Content-Type: application/json
Body: none

Successful Response
Status Code: 200
Headers:
Content-Type: application/json
Body:
{
  "orderId": 1,
  "message": "Order completed successfully"
}

## FAVORITES

### Get Favorites
Returns the current user's favorite products.
Require Authentication: true
Request
Method: GET
Route path: /api/favorites
Body: none

Successful Response
Status Code: 200
Headers:
Content-Type: application/json
Body:
{
  "Favorites": [
    {
      "id": 1,
      "userId": 1,
      "productId": 1,
      "Product": {
        "id": 1,
        "name": "Pure Cashmere Neck Warmer",
        "price": 60,
        "previewImage": "image url"
      }
    }
  ]
}

### Add to Favorites
Adds a product to the user's favorites.
Require Authentication: true
Request
Method: POST
Route path: /api/favorites
Headers:
Content-Type: application/json
Body:
{
  "productId": 1
}

Successful Response
Status Code: 201
Headers:
Content-Type: application/json
Body:
{
  "id": 1,
  "userId": 1,
  "productId": 1
}

### Remove from Favorites
Removes a product from the user's favorites.
Require Authentication: true
Request
Method: DELETE
Route path: /api/favorites/:productId
Body: none

Successful Response
Status Code: 200
Headers:
Content-Type: application/json
Body:
{
  "message": "Successfully removed from favorites"
}
